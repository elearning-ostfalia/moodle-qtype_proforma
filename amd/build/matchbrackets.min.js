function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){if("object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module)))a(require("qtype_proforma/codemirror"));else if("function"==typeof define&&define.amd)define ("qtype_proforma/matchbrackets",["qtype_proforma/codemirror"],a);else a(CodeMirror)})(function(a){var g=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||8>document.documentMode),h=a.Pos,i={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function b(a){return a&&a.bracketRegex||/[(){}[\]]/}function c(a,c,e){var f=a.getLineHandle(c.line),g=c.ch-1,j=e&&e.afterCursor;if(null==j)j=/(^| )cm-fat-cursor($| )/.test(a.getWrapperElement().className);var k=b(e),l=!j&&0<=g&&k.test(f.text.charAt(g))&&i[f.text.charAt(g)]||k.test(f.text.charAt(g+1))&&i[f.text.charAt(++g)];if(!l)return null;var m=">"==l.charAt(1)?1:-1;if(e&&e.strict&&0<m!=(g==c.ch))return null;var n=a.getTokenTypeAt(h(c.line,g+1)),o=d(a,h(c.line,g+(0<m?1:0)),m,n||null,e);if(null==o)return null;return{from:h(c.line,g),to:o&&o.pos,match:o&&o.ch==l.charAt(0),forward:0<m}}function d(a,c,d,e,f){for(var g=f&&f.maxScanLineLength||1e4,j=f&&f.maxScanLines||1e3,k=[],l=b(f),m=0<d?Math.min(c.line+j,a.lastLine()+1):Math.max(a.firstLine()-1,c.line-j),n=c.line,o;n!=m;n+=d){o=a.getLine(n);if(!o)continue;var p=0<d?0:o.length-1,q=0<d?o.length:-1;if(o.length>g)continue;if(n==c.line)p=c.ch-(0>d?1:0);for(;p!=q;p+=d){var r=o.charAt(p);if(l.test(r)&&(e===void 0||a.getTokenTypeAt(h(n,p+1))==e)){var s=i[r];if(s&&">"==s.charAt(1)==0<d)k.push(r);else if(!k.length)return{pos:h(n,p),ch:r};else k.pop()}}}return n-d==(0<d?a.lastLine():a.firstLine())?!1:null}function e(a,b,d){for(var e=a.state.matchBrackets.maxHighlightLineLength||1e3,f=[],j=a.listSelections(),k=0,l;k<j.length;k++){l=j[k].empty()&&c(a,j[k].head,d);if(l&&a.getLine(l.from.line).length<=e){var m=l.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";f.push(a.markText(l.from,h(l.from.line,l.from.ch+1),{className:m}));if(l.to&&a.getLine(l.to.line).length<=e)f.push(a.markText(l.to,h(l.to.line,l.to.ch+1),{className:m}))}}if(f.length){if(g&&a.state.focused)a.focus();var n=function(){a.operation(function(){for(var a=0;a<f.length;a++){f[a].clear()}})};if(b)setTimeout(n,800);else return n}}function f(a){a.operation(function(){if(a.state.matchBrackets.currentlyHighlighted){a.state.matchBrackets.currentlyHighlighted();a.state.matchBrackets.currentlyHighlighted=null}a.state.matchBrackets.currentlyHighlighted=e(a,!1,a.state.matchBrackets)})}a.defineOption("matchBrackets",!1,function(b,c,d){if(d&&d!=a.Init){b.off("cursorActivity",f);if(b.state.matchBrackets&&b.state.matchBrackets.currentlyHighlighted){b.state.matchBrackets.currentlyHighlighted();b.state.matchBrackets.currentlyHighlighted=null}}if(c){b.state.matchBrackets="object"==_typeof(c)?c:{};b.on("cursorActivity",f)}});a.defineExtension("matchBrackets",function(){e(this,!0)});a.defineExtension("findMatchingBracket",function(a,b,d){if(d||"boolean"==typeof b){if(!d){b=b?{strict:!0}:null}else{d.strict=b;b=d}}return c(this,a,b)});a.defineExtension("scanForBracket",function(a,b,c,e){return d(this,a,b,c,e)})});
//# sourceMappingURL=matchbrackets.min.js.map
